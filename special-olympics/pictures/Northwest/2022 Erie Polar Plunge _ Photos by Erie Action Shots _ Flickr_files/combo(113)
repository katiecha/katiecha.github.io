YUI.add("fluid-fullscreen",(function(e){"use strict";function n(){var n=e.config.doc;return n.fullscreenEnabled||n.webkitFullscreenEnabled||n.mozFullScreenEnabled||n.msFullscreenEnabled}function l(){var n=e.config.doc;return n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement}e.mix(e.Node.DOM_EVENTS,{fullscreenchange:!0,webkitfullscreenchange:!0,mozfullscreenchange:!0,MSFullscreenChange:!0}),e.namespace("fluid").Fullscreen=function(){this.fullscreenChangeHandler=e.on("fullscreenchange",this.handleFullscreenChange.bind(this)),this.webkitFullscreenChangeHandler=e.on("webkitfullscreenchange",this.handleFullscreenChange.bind(this)),this.mozFullscreenChangeHandler=e.on("mozfullscreenchange",this.handleFullscreenChange.bind(this)),this.msFullscreenChangeHandler=e.on("MSFullscreenChange",this.handleFullscreenChange.bind(this)),this.publish("enterFullscreen"),this.publish("exitFullscreen")},e.fluid.Fullscreen.prototype={isFullscreenCapable:n,isInFullscreenMode:l,enterFullscreen:function(l){var r=e.config.doc.documentElement;if(l&&(r=l.getDOMNode()),n()){if(r.requestFullscreen)return r.requestFullscreen();if(r.webkitRequestFullscreen)return r.webkitRequestFullscreen();if(r.mozRequestFullScreen)return r.mozRequestFullScreen();if(r.msRequestFullscreen)return r.msRequestFullscreen()}return!1},exitFullscreen:function(){var n=e.config.doc;if(l()){if(n.exitFullscreen)return n.exitFullscreen();if(n.webkitExitFullscreen)return n.webkitExitFullscreen();if(n.mozCancelFullScreen)return n.mozCancelFullScreen();if(n.msExitFullscreen)return n.msExitFullscreen()}return!1},handleFullscreenChange:function(){this.isInFullscreenMode()?this.fire("enterFullscreen"):this.fire("exitFullscreen")},destroy:function(){this.fullscreenChangeHandler.detach(),this.webkitFullscreenChangeHandler.detach(),this.mozFullscreenChangeHandler.detach(),this.msFullscreenChangeHandler.detach()}},e.augment(e.fluid.Fullscreen,e.EventTarget,!0,null,{prefix:"fullscreen"})}),"@VERSION@",{requires:["event-custom"],optional:[],affinity:"client"});YUI.add("fluid-magic-slideshow-view",(function(i){i.namespace("Views")[this.name]=i.Base.create("fluid-magic-slideshow-view",i.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.modelParams=e.photoListConfig.modelParams,this.pageParams=e.pageParams,this.modelParams.fetchParams&&(this.pageParams=i.merge(this.modelParams.fetchParams,this.pageParams)),this.pageParams.viewPageSize?this.positionMultipler=this.pageParams.viewPageSize:this.positionMultipler=this.pageParams.perPage,this},loadState:function(){var i=this;return this.appContext.getModel(this.modelParams.registryName,this.modelParams.modelIdOrAttributes,this.modelParams.fetchParams).then((function(e){i.position=(i.pageParams.nominalPage-1)*i.positionMultipler||0,i.collection=e.getValue("photoPageList"),i.isEnabled=i.collection.totalItems>0})).catch((function(i){}))},buildContainer:function(){return this.setContainerWithTemplate("fluid-magic-slideshow",{isEnabled:this.isEnabled}),this},toggleSlideshow:function(e){i.rapidTracker.beacon(this.name,"launchSlideshow"),e.halt(),new i.Views.Slideshow({appContext:this.appContext,collection:this.collection,pageParams:this.pageParams,position:this.position}).show()},activate:function(){return this.isEnabled&&this.registerEventHandler(this.get("container").one(".slideshow-toggle").on("click",this.toggleSlideshow.bind(this))),this}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-fluid-magic-slideshow","slideshow-view"],langBundles:["common"]});YUI.add("hermes-template-photostream-filter-tools",(function(e,a){var l=e.Template.Handlebars.revive({1:function(e,a,l,n,t){var r,o=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="dropdown-link filter-view" aria-haspopup="true" aria-expanded="false" tabindex="0"><p>'+e.escapeExpression("function"==typeof(r=null!=(r=o(l,"filterValue")||(null!=a?o(a,"filterValue"):a))?r:e.hooks.helperMissing)?r.call(null!=a?a:e.nullContext||{},{name:"filterValue",hash:{},data:t,loc:{start:{line:3,column:98},end:{line:3,column:113}}}):r)+"</p><span></span></div>\n"},compiler:[8,">= 4.3.0"],main:function(e,a,l,n,t){var r,o,i=null!=a?a:e.nullContext||{},s=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="dropdown-link filter-sort" aria-haspopup="true" aria-expanded="false" tabindex="0"><p>'+e.escapeExpression("function"==typeof(o=null!=(o=s(l,"sortValue")||(null!=a?s(a,"sortValue"):a))?o:e.hooks.helperMissing)?o.call(i,{name:"sortValue",hash:{},data:t,loc:{start:{line:1,column:98},end:{line:1,column:111}}}):o)+"</p><span></span></div>\n"+(null!=(r=s(l,"if").call(i,null!=a?s(a,"viewingSelf"):a,{name:"if",hash:{},fn:e.program(1,t,0),inverse:e.noop,data:t,loc:{start:{line:2,column:0},end:{line:4,column:7}}}))?r:"")},useData:!0}),n={};e.Array.each([],(function(a){var l=e.Template.get("hermes/"+a);l&&(n[a]=l)})),e.Template.register("hermes/photostream-filter-tools",(function(a,t){return(t=t||{}).partials=t.partials?e.merge(n,t.partials):n,l(a,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photostream-filter-tools-view",(function(e){var t={filterView:".filter-view",filterSort:".filter-sort",help:".filter-helper .filter-helper-icon"},r={me:"filter-bar.VIEW_ALL",fr:"filter-bar.FRIEND",fa:"filter-bar.FAMILY",ff:"filter-bar.FRIEND_AND_FAMILY",pu:"filter-bar.PUBLIC",dt:"cameraroll.DATE_TAKEN",dc:"cameraroll.DATE_UPLOADED"};e.namespace("Views")[this.name]=e.Base.create("photostream-filter-tools-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.nsid=e.nsid,this.set("viewingSelf",this.appContext.getViewer().nsid===this.nsid),this},loadState:function(){var t=this,r=[];return this.appContext.getViewer().signedIn&&r.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid).then((function(r){t.set("personPreferenceModel",r),t.set("filterValue",e.Models["person-preferences-models"].getReadablePrefName(r.getValue("photostreamViewAsPref"))),t.set("sortValue",e.Models["person-preferences-models"].getReadablePrefName(r.getValue("photostreamViewOrderPref")))}))),e.Promise.all(r)},buildContainer:function(){var e=this.get("personPreferenceModel");return this.setContainerWithTemplate("photostream-filter-tools",{viewingSelf:this.get("viewingSelf"),sortValue:this.intlMessage({intlName:r[e.getValue("photostreamViewOrderPref")]}),filterValue:this.intlMessage({intlName:r[e.getValue("photostreamViewAsPref")]})}),this},activate:function(){return this.get("viewingSelf")&&(this.registerEventHandler(this.get("container").one(t.filterView).on("click",this.handleFilterView,this)),e.Accessibility.makeDroparoundAnchorAccessible({view:this,getDroparound:this.getDroparound.bind(this),anchor:this.get("container").one(".filter-view"),handler:this.handleFilterView.bind(this)})),this.registerEventHandler(this.get("container").one(t.filterSort).on("click",this.handleFilterSort,this)),e.Accessibility.makeDroparoundAnchorAccessible({view:this,getDroparound:this.getDroparound.bind(this),anchor:this.get("container").one(".filter-sort"),handler:this.handleFilterSort.bind(this)}),this},getDroparound:function(){return this.dropdown},handleFilterSort:function(t){t.halt();var r=this;this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:t.target.one("span"),keyboardAnchorElement:t.target,minVerticalSpace:400,positionFixed:!0,preferLeft:!0,closeOnScroll:!0,menuItems:[{text:this.intlMessage({intlName:"cameraroll.DATE_UPLOADED"}),data:"dateposted"},{text:this.intlMessage({intlName:"cameraroll.DATE_TAKEN"}),data:"datetaken"}]}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",(function(e){e&&e.menuItem&&(r.get("container").one(".filter-sort p").set("text",e.menuItem.text),r.set("sortValue",e.menuItem.data),r.notifyPhotostreamToUpdate()),r.dropdown.close()})),this)},handleFilterView:function(t){t.halt();var r=this;this.dropdown=new e.Views.FluidDroparound({appContext:this.appContext,showDropArrow:!0,observePageResize:!0,anchorElement:t.target.one("span"),keyboardAnchorElement:t.target,minVerticalSpace:400,preferLeft:!0,closeOnScroll:!0,positionFixed:!0,menuItems:[{text:this.intlMessage({intlName:"filter-bar.PUBLIC"}),data:"public"},{text:this.intlMessage({intlName:"filter-bar.FRIEND"}),data:"friend"},{text:this.intlMessage({intlName:"filter-bar.FAMILY"}),data:"family"},{text:this.intlMessage({intlName:"filter-bar.FRIEND_AND_FAMILY"}),data:"ff"},{text:this.intlMessage({intlName:"filter-bar.VIEW_ALL"}),data:"me"}]}),this.dropdown.show(),this.registerEventHandler(this.dropdown.on("selected",(function(e){e&&e.menuItem&&(r.get("container").one(".filter-view p").set("text",e.menuItem.text),r.set("filterValue",e.menuItem.data),r.notifyPhotostreamToUpdate()),r.dropdown.close()})),this)},notifyPhotostreamToUpdate:function(){var t=this;this.get("personPreferenceModel").setValues({photostreamViewAsPref:e.Models["person-preferences-models"].PHOTOSTREAM_VIEW_AS_TYPES[this.get("filterValue")],photostreamViewOrderPref:e.Models["person-preferences-models"].PHOTOSTREAM_VIEW_ORDER_TYPES[this.get("sortValue")]}),e.fire("loader:start"),this.get("personPreferenceModel").remoteUpdate().then((function(){t.fire("subviewViewEvent","photostream:filter",{filterValue:t.get("filterValue"),sortValue:t.get("sortValue")})}))}},{ATTRS:{filterValue:{value:"me"},sortValue:{value:"dateposted"}}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","fluid-droparound-view","hermes-template-photostream-filter-tools"],langBundles:["cameraroll","filter-bar"]});YUI.add("hermes-template-fluid-magic-tools",(function(l,t){var e=l.Template.Handlebars.revive({1:function(l,t,e,n,a){var o=l.lookupProperty||function(l,t){if(Object.prototype.hasOwnProperty.call(l,t))return l[t]};return'\t\t<div class="share-link">\n\t\t\t'+l.escapeExpression((o(e,"outlet")||t&&o(t,"outlet")||l.hooks.helperMissing).call(null!=t?t:l.nullContext||{},null!=t?o(t,"shareView"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:9,column:3},end:{line:9,column:23}}}))+"\n\t\t</div>\n"},3:function(l,t,e,n,a){var o,i=null!=t?t:l.nullContext||{},r=l.hooks.helperMissing,s=l.escapeExpression,u=l.lookupProperty||function(l,t){if(Object.prototype.hasOwnProperty.call(l,t))return l[t]};return'\t\t\t<a class="edit-link" href="'+s("function"==typeof(o=null!=(o=u(e,"editUrl")||(null!=t?u(t,"editUrl"):t))?o:r)?o.call(i,{name:"editUrl",hash:{},data:a,loc:{start:{line:16,column:30},end:{line:16,column:41}}}):o)+'" title="'+s((u(e,"intlMessage")||t&&u(t,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"photostream.EDIT_PHOTO_INFO"},data:a,loc:{start:{line:16,column:50},end:{line:16,column:104}}}))+'">\n\t\t\t\t<span class="fluid-edit-icon"></span>\n\t\t\t</a>\n'},compiler:[8,">= 4.3.0"],main:function(l,t,e,n,a){var o,i=null!=t?t:l.nullContext||{},r=l.hooks.helperMissing,s=l.escapeExpression,u=l.lookupProperty||function(l,t){if(Object.prototype.hasOwnProperty.call(l,t))return l[t]};return'<div class="fluid-centered fluid-magic-toolbar">\n\t<div class="primary-tools-container">\n\t\t'+s((u(e,"outlet")||t&&u(t,"outlet")||r).call(i,null!=t?u(t,"photostream-filter-tools-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:3,column:2},end:{line:3,column:42}}}))+'\n\t</div>\n\n\t<div class="secondary-tools">\n'+(null!=(o=u(e,"if").call(i,null!=t?u(t,"shareView"):t,{name:"if",hash:{},fn:l.program(1,a,0),inverse:l.noop,data:a,loc:{start:{line:7,column:2},end:{line:11,column:9}}}))?o:"")+"\t\t"+s((u(e,"outlet")||t&&u(t,"outlet")||r).call(i,null!=t?u(t,"fluid-magic-slideshow-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:12,column:2},end:{line:12,column:39}}}))+"\n\t\t"+s((u(e,"outlet")||t&&u(t,"outlet")||r).call(i,null!=t?u(t,"fluid-magic-search-view"):t,{name:"outlet",hash:{},data:a,loc:{start:{line:13,column:2},end:{line:13,column:36}}}))+"\n\n"+(null!=(o=u(e,"if").call(i,null!=t?u(t,"displayEditLink"):t,{name:"if",hash:{},fn:l.program(3,a,0),inverse:l.noop,data:a,loc:{start:{line:15,column:2},end:{line:19,column:9}}}))?o:"")+"\t</div>\n</div>\n"},useData:!0}),n={};l.Array.each([],(function(t){var e=l.Template.get("hermes/"+t);e&&(n[t]=e)})),l.Template.register("hermes/fluid-magic-tools",(function(t,a){return(a=a||{}).partials=a.partials?l.merge(n,a.partials):n,e(t,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("fluid-magic-tools-view",(function(e){e.namespace("Views")[this.name]=e.Base.create("fluid-magic-tools-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this.set("selected",""),this.set("isEmptyPage",e.isEmptyPage),e.subnavConfig&&e.subnavConfig.selected&&this.set("selected",e.subnavConfig.selected),this.ownerNsid=e.nsid,this.page=e.pageParams&&e.pageParams.nominalPage,this},loadState:function(){var i=this;return e.Promise.resolve(this.appContext.getModel("person-models",this.ownerNsid)).then((function(e){i.set("personModel",e)}))},subviewConfig:{"fluid-share-photostream-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,parentViewName:this.name,disabled:function(e){return"photostream"!==this.get("selected")}},"fluid-share-favorites-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,parentViewName:this.name,disabled:function(e){return"favorites"!==this.get("selected")}},"photostream-filter-tools-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return"photostream"!==this.get("selected")||!this.appContext.getViewer().signedIn},additionalViewClasses:["primary-tools"]},"fluid-magic-search-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!!this.get("isEmptyPage")},additionalViewClasses:["closed"]},"fluid-magic-slideshow-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!!this.get("isEmptyPage")}}},buildContainer:function(){var i,t=this.appContext.getViewer(),s=t.signedIn&&t.nsid===this.ownerNsid,r=e.URLHelper.generatePersonUrls(this.get("personModel"));return i={shareView:this.getShareViewContainer(),displayEditLink:"photostream"===this.get("selected")&&s&&!this.get("isEmptyPage")},null!==this.appContext.getLocation().href.match(/\/photos\/[^\/]+\/page/)?i.editUrl=r.photostreamEdit+"/page"+this.page:i.editUrl=r.photostreamEdit,this.setContainerWithTemplate("fluid-magic-tools",i),this},getShareViewContainer:function(){var e="";return this.subviews["fluid-share-"+this.get("selected")+"-view"]&&(e=this.subviews["fluid-share-"+this.get("selected")+"-view"].get("container")),e}})}),"@VERSION@",{requires:["flutil","flickr-view","flickr-promise","fluid-share-photostream-view","fluid-share-favorites-view","fluid-magic-slideshow-view","photostream-filter-tools-view","hermes-template-fluid-magic-tools"],langBundles:["share-modal","common","photostream"]});YUI.add("hermes-lang-photostream",(function(e,a){e.Intl.add("hermes/photostream","en-US",{EDIT_CAMERAROLL_ORGANIZR:[{type:0,value:'Edit in <a href="'},{type:1,value:"camerarollUrl"},{type:0,value:'">Camera Roll</a> or <a href="'},{type:1,value:"organizrUrl"},{type:0,value:'">Organizr</a>'}],EDIT_PHOTO_INFO:[{type:0,value:"Edit photo info"}]})}),"@VERSION@",{requires:["intl"]});YUI.add("empty-page-view",(function(e,t){var a=require("hermes-core/flog")(t),i=(new e.SubscriptionsHelper,{width:125,size:"q"});e.namespace("Views")[this.name]=e.Base.create("empty-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var a;return this.page=t.page,this.subPage=t.subPage,this.viewAs=t.viewAs,this.isSlow=t.isSlow,"cameraroll"===this.page&&(this.subPage=t.mapType),t.nsid||(t.nsid=this.appContext.getViewer().nsid),this.nsid=t.nsid,this.displayName=t.displayName,this.isHelloPro=t.isHelloPro,this.isCamerarollPhotostream=t.isCamerarollPhotostream,t.subnavConfig={selected:this.isCamerarollPhotostream?"cameraroll":this.page},t.isEmptyPage=!0,t.numItemsUploadedForNotification=5,t.willNavigateAfterInitialUpload=!0,a=YUI.Env.isServer?e.BrowserSupport.getOSString(this.appContext.request.headers["user-agent"]):e.UA.os,this.showMacBanner="macintosh"===a,this.showWindowsBanner="windows"===a,this.showUploadrBanner=(this.showMacBanner||this.showWindowsBanner)&&!e.StorageHelper.getItem("hasDismissedCameraRollUploaderBanner")&&this.isYou(this.nsid),this.appContext.flipper.isFlipped("disable-uploadr-ads")&&(this.showUploadrBanner=!1),this.geo=t.geo||!1,this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-photostream-coverphoto-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-magic-subnav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"fluid-magic-tools-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.isYou(this.nsid)&&"photostream"!==this.page}},"cameraroll-tools-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!1,additionalViewClasses:function(){return["restyle"]},disabled:function(){return"cameraroll"!==this.page}},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"uploader-minimal-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return"cameraroll"!==this.page}}},loadState:function(){return e.Promise.resolve()},isYou:function(e){return this.appContext.getViewer().nsid===e},generateFakeDateTitle:function(t,a,i){return"zh-HK"===this.appContext.lang?t+" 年 "+a+" 月 "+i+" 日":this.intlMessage({intlName:"cameraroll.DATE_TITLE",intlDate:e.moment(t+"-"+a+"-"+i,"YYYY-MM-DD").toDate()})},buildContainer:function(){var t={},a=600,i=50,o=this.appContext.viewportData.getHeight()-50-250-70-109;return"cameraroll"===this.page?(i=4,o-=50,a=Math.max(450,o)-i-1):"albums"===this.page?a=Math.max(450,o)-i-1+46:"photostream"===this.page?(this.isYou(this.nsid)&&(o-=50),a=Math.max(450,o)-i-1+46):("favorites"===this.page||"galleries"===this.page)&&(a=Math.max(450,o)-i-1+46),"cameraroll"===this.page&&(t.twentyfifteen=2015,t.twentyfourteen=2014,t.march=this.intlMessage({intlName:"common."+e.moment("2015-03-01").format("MMMM").toUpperCase()}),t.april=this.intlMessage({intlName:"common."+e.moment("2015-04-01").format("MMMM").toUpperCase()}),t.aprilthirty=this.generateFakeDateTitle(2015,4,30),t.marchone=this.generateFakeDateTitle(2015,3,1),t.decemberthirteen=this.generateFakeDateTitle(2014,12,13),t.decembertwelve=this.generateFakeDateTitle(2014,12,12),t.octoberthirtyone=this.generateFakeDateTitle(2014,10,31),t.octobertwentyfour=this.generateFakeDateTitle(2014,10,24)),this.setContainerWithTemplate("empty-page",{"fluid-header":this.subviews["fluid-photostream-coverphoto-view"]?this.subviews["fluid-photostream-coverphoto-view"].get("container"):"",page:this.page,"the-page":this.templates("empty-page-"+this.page)({displayName:this.displayName,isYou:this.isYou(this.nsid),viewAs:this.viewAs,fakeDates:t,subPage:this.subPage,minHeight:a,isSlow:this.isSlow,isCamerarollPhotostream:this.isCamerarollPhotostream}),isYou:this.isYou(this.nsid),showUploadrBanner:this.showUploadrBanner,isMac:this.showMacBanner,isWindows:this.showWindowsBanner,isSlow:this.isSlow}),this},activate:function(){var t=e.one(".uploadr-banner-small");return"cameraroll"===this.page&&(this.cameraRollWidth=0,this.handleCamerarollResize()),this.registerEventHandler(e.globalEvents.subscribe("window:resize",this.handleResize.bind(this))),t&&!this.isSlow&&(e.StorageHelper.getItem("hasDismissedCameraRollUploaderBanner")||(t.removeClass("is-hidden"),this.registerEventHandler(t.one(".butt").on("click",this.handleBannerDownload.bind(this))),e.rapidTracker.beacon(this.name,"showUploadrBanner"))),this.isHelloPro?this.appContext.getModel("person-models",this.nsid).then(function(e){this.showHelloProModal(e)}.bind(this)):this},onSubviewEvent:function(t,a){var i=a[0],o=this.appContext;"photostream:filter"===i?this.appContext.flapp.navigate(window.location.href):"initialUploadsComplete"===i?"cameraroll"===this.page&&e.Promise.all([o.getModelRegistry("cameraroll-tags-map-models"),o.getModelRegistry("cameraroll-dates-map-models"),o.getModelRegistry("person-profile-models")]).then((function(e){e.forEach((function(e){e.removeAll()})),o.flapp.navigate(o.getLocation().href)})):e.Env.isServer||"camerarollTools:sortOrder"!==i||this.sortOrderChange(a[1])},handleResize:function(e){"cameraroll"===this.page&&this.handleCamerarollResize(e);var t=600,a=0,i=this.appContext.viewportData.getHeight()-50-250-70-109,o=this.get("container").one(".empty-page"),r=".wrap";"cameraroll"===this.page?(a=4,i-=50,t=Math.max(450,i)-a-1,r=".copy"):"albums"===this.page?t=Math.max(450,i)-a-1+46:"photostream"===this.page?(i-=50,t=Math.max(450,i)-a-1+46):("favorites"===this.page||"galleries"===this.page)&&(t=Math.max(450,i)-a-1+46),o.one(r)&&o.one(r).setStyles({minHeight:t+"px"})},handleCamerarollResize:function(e){var t,a,o,r=this.get("container").one(".height-controller"),s=r.all(".date-container .cameraroll-item-placeholder"),n=this.calculateCamerarollWidthAndMargin(),l=i.width;this.cameraRollWidth!==n.width&&(this.cameraRollWidth=n.width,o=(t=this.cameraRollWidth)-((l+10)*(a=Math.floor((t+10)/(l+10)))-10),this.itemWidth=Math.max(l,l+o/a),r.all(".date-container").setStyles({width:t+10}),s.setStyles({width:this.itemWidth,height:this.itemWidth}),this.get("container").one(".mock-cameraroll").setStyles({display:"block"}))},sortOrderChange:function(e){var t,i=this;"date_posted"===e?t="dc":"date_taken"===e?t="dt":"autotags"===e&&(t="at"),this.appContext.callAPI("flickr.prefs.setPrefs",{camera_roll_view_pref:t}).then((function(){i.appContext.flapp.navigate("/cameraroll")}),(function(e){a.error("Error changing cameraroll tools pref",{err:e}),i.appContext.flapp.navigate("/cameraroll")}))},calculateCamerarollWidthAndMargin:function(){var e,t,a=this.appContext.viewportData.getWidth();return t=Math.max(130,.1*a),e=Math.max(800,a-2*t),{margin:Math.round(t),width:Math.round(e)}},handleBannerDownload:function(t){var a=t.target.getAttribute("href");t.preventDefault(),e.rapidTracker.beacon(this.name,this.showMacBanner?"macUploaderBannerDownloadClick":"windowsUploaderBannerDownloadClick"),e.StorageHelper.setItem("hasDismissedCameraRollUploaderBanner",!0),this.get("container").one(".uploadr-banner-small").remove(),e.config.win.location=a},showHelloProModal:function(t){var a=e.URLHelper.generatePersonUrls(t),i=new e.Views.FluidModal({actionButtonLabel:this.intlMessage({intlName:"checkout.OK_THANKS"}),htmlMessage:this.templates("pro-hello-pro")({photostreamURL:e.url(a.photostream)}),showBodyLines:!0,showHeader:!1,appContext:this.appContext,dismissOnOverlayClick:!1,dismissOnActionClick:!0,actionButtonDisabled:!1,actionButtonIsDangerous:!1,showCancelButton:!1,classList:"welcome-pro-modal",showCancelX:!1});i.on("activated",(function(t){setTimeout((function(){e.config.win.history.replaceState({},"",a.photostream)}),1e3)})),i.on("actionClick",(function(t){e.config.win.location=e.url(a.photostream)})),i.show()}},{ATTRS:{}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","moment","hermes-template-empty-page","hermes-template-empty-page-cameraroll","hermes-template-empty-page-photostream","hermes-template-empty-page-albums","hermes-template-empty-page-favorites","hermes-template-empty-page-creations","hermes-template-empty-page-stats","hermes-template-empty-page-galleries","hermes-template-pro-hello-pro","global-nav-view","footer-full-view","hermes-template-flickr-balls","fluid-magic-tools-view","browser-support","url-helper","subscriptions-helper","url"],optionalRequires:["hermes-core"],langBundles:["common","magic-empty-states","cameraroll","photo-page","checkout","photo-page-scrappy"]});