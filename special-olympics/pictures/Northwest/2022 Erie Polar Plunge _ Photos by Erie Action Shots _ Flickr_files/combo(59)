YUI.add("album-list-toolbar-view",(function(i){i.FlickrView.create(this.name,i.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{},initializer:function(i){return""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.nsid=i.nsid,this},loadState:function(){return this.appContext.getModel("person-models",this.nsid).then(function(i){this.set("person",i),this.set("isViewingSelf",this.nsid===this.appContext.getViewer().nsid)}.bind(this),(function(i){}))},buildContainer:function(){var t=this.get("person")&&i.URLHelper.generatePersonUrls(this.get("person"));return this.setContainerWithTemplate("album-list-toolbar",{urls:t,isViewingSelf:this.get("isViewingSelf")}),this},buildErrorContainer:function(){},activate:function(){return this}})}),"@VERSION@",{requires:["flickr-view","url-helper","hermes-template-album-list-toolbar"],optional:[],langBundles:["album-page","common"]});YUI.add("hermes-template-head-meta",(function(e,n){var a=e.Template.Handlebars.revive({1:function(e,n,a,t,l){return'name="'},3:function(e,n,a,t,l){return'property="'},5:function(e,n,a,t,l){return'description="'+e.escapeExpression(e.lambda(n,n))+'"'},compiler:[8,">= 4.3.0"],main:function(e,n,a,t,l){var r,o,i,m=null!=n?n:e.nullContext||{},s=e.hooks.helperMissing,c="function",u=e.escapeExpression,p=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]},d="<meta "+(null!=(r=p(a,"if").call(m,null!=n?p(n,"isName"):n,{name:"if",hash:{},fn:e.program(1,l,0),inverse:e.program(3,l,0),data:l,loc:{start:{line:1,column:6},end:{line:1,column:51}}}))?r:"")+u(typeof(o=null!=(o=p(a,"metaName")||(null!=n?p(n,"metaName"):n))?o:s)===c?o.call(m,{name:"metaName",hash:{},data:l,loc:{start:{line:1,column:51},end:{line:1,column:63}}}):o)+'" content="'+u((p(a,"renderMetaInfo")||n&&p(n,"renderMetaInfo")||s).call(m,null!=n?p(n,"metaValue"):n,{name:"renderMetaInfo",hash:{},data:l,loc:{start:{line:1,column:74},end:{line:1,column:102}}}))+'" ';return o=null!=(o=p(a,"metaDescription")||(null!=n?p(n,"metaDescription"):n))?o:s,i={name:"metaDescription",hash:{},fn:e.program(5,l,0),inverse:e.noop,data:l,loc:{start:{line:1,column:104},end:{line:1,column:163}}},r=typeof o===c?o.call(m,i):o,p(a,"metaDescription")||(r=e.hooks.blockHelperMissing.call(n,r,i)),null!=r&&(d+=r),d+' data-dynamic="true">\n'},useData:!0}),t={};e.Array.each([],(function(n){var a=e.Template.get("hermes/"+n);a&&(t[n]=a)})),e.Template.register("hermes/head-meta",(function(n,l){return(l=l||{}).partials=l.partials?e.merge(t,l.partials):t,a(n,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-lang-shared-entity",(function(e,t){e.Intl.add("hermes/shared-entity","en-US",{USERNAME_HAS_SHARED_PHOTOS_ONLY:[{type:1,value:"username"},{type:0,value:" has shared "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" photo"}]},other:{value:[{type:7},{type:0,value:" photos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" with you!"}],USERNAME_HAS_SHARED_VIDEOS_ONLY:[{type:1,value:"username"},{type:0,value:" has shared "},{type:6,value:"videoCount",options:{one:{value:[{type:7},{type:0,value:" video"}]},other:{value:[{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" with you!"}],USERNAME_HAS_SHARED_PHOTOS_VIDEOS:[{type:1,value:"username"},{type:0,value:" has shared "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" photo"}]},other:{value:[{type:7},{type:0,value:" photos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" "},{type:6,value:"videoCount",options:{one:{value:[{type:0,value:"and "},{type:7},{type:0,value:" video"}]},other:{value:[{type:0,value:"and "},{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" with you!"}],OWNER_HAS_SHARED_PHOTOS_ONLY:[{type:0,value:"You have shared "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" photo"}]},other:{value:[{type:7},{type:0,value:" photos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:"."}],OWNER_HAS_SHARED_VIDEOS_ONLY:[{type:0,value:"You have shared "},{type:6,value:"videoCount",options:{one:{value:[{type:7},{type:0,value:" video"}]},other:{value:[{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:"."}],OWNER_HAS_SHARED_PHOTOS_VIDEOS:[{type:0,value:"You have shared "},{type:6,value:"photoCount",options:{one:{value:[{type:7},{type:0,value:" photo"}]},other:{value:[{type:7},{type:0,value:" photos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:" "},{type:6,value:"videoCount",options:{one:{value:[{type:0,value:"and "},{type:7},{type:0,value:" video"}]},other:{value:[{type:0,value:"and "},{type:7},{type:0,value:" videos"}]}},offset:0,pluralType:"cardinal"},{type:0,value:"."}],VIEW_YOUR_SHARING_HISTORY:[{type:0,value:"View your sharing history"}]})}),"@VERSION@",{requires:["intl"]});YUI.add("flickr-favorites-getContext-fetcher",(function(e,o){"use strict";e.namespace("ListFetchers")["flickr-favorites-getContext"]={run:function(t,s){var r=this;return e.Promise.all([s.callAPI("flickr.favorites.getContext",this._processParams(t),!0),s.getModelRegistry("favorite-models"),s.getModelRegistry("photo-models"),s.getModelRegistry("person-models"),s.getModelRegistry("photo-engagement-models"),s.getModelRegistry("photo-stats-models")]).then((function(e){return r._processResponse(e,t)}),(function(e){throw 3===e.code&&"Photo not a favorite"===e.message&&(e.notInContext=!0),e})).then(null,e.FetcherErrorLogger(o))},_processParams:function(o){var t={photo_id:o.photoId,num_prev:o.numNext,num_next:o.numPrev,extras:e.APIHelper.request.getRebootPhotoExtras()};return o.id?t.user_id=o.id:t.path_alias=o.pathAlias,t},_processResponse:function(o,t){var s,r,n,a,p,i,l,h,d=o[0],g=o[1],u=o[2],m=o[3],c=o[4],x=o[5],y=[],M=u.proxy(t.photoId);return r=d.prevphotos,n=d.nextphotos,s=e.APIHelper.response.parsePhotos({photos:r.photo,personModelRegistry:m,photoModelRegistry:u,photoEngagementModelRegistry:c,photoStatsModelRegistry:x}),y=e.APIHelper.response.parsePhotos({photos:n.photo,personModelRegistry:m,photoModelRegistry:u,photoEngagementModelRegistry:c,photoStatsModelRegistry:x}),p=!!(l=g.getValue(t.id,"photoContextList")).hasMinBoundary&&l.hasMinBoundary(),i=!!l.hasMaxBoundary&&l.hasMaxBoundary(),a=l.getList(),h=e.APIHelper.response.addOrReplaceListByContext({model:M,next:s,prev:y.reverse(),hasMax:i,hasMin:p,current:a,numNext:t.numNext,numPrev:t.numPrev}),g.setValue(t.id,"photoContextList",h),{next:s,previous:y.reverse()}}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["favorite-models","photo-models","person-models","photo-engagement-models","photo-stats-models"]});YUI.add("flickr-favorites-getList-fetcher",(function(e,o){"use strict";e.namespace("ListFetchers")["flickr-favorites-getList"]={run:function(t,s){var r=this;return e.Promise.all([s.callAPI("flickr.favorites.getList",this._processParams(t)),s.getModelRegistry("photo-models"),s.getModelRegistry("person-models"),s.getModelRegistry("favorite-models"),s.getModelRegistry("photo-engagement-models"),s.getModelRegistry("photo-stats-models"),s.getModelRegistry("gallery-photo-association-models"),s.getModelRegistry("gallery-faves-models")]).then((function(e){return r._processResponse(e,t)}),e.FetcherErrorLogger(o))},_processParams:function(o){var t={extras:e.APIHelper.request.getRebootPhotoExtras(),per_page:o.perPage||20,page:o.page||1,get_user_info:1,jump_to:o.withPhotoId||""};if(o.id||o.userId)t.user_id=(o.id||o.userId).split("-")[0];else{if(!o.pathAlias)throw new Error("[flickr-favorites-getList-fetcher] `id` or `pathAlias` is required.");t.path_alias=o.pathAlias}return o.galleryId&&(t.gallery_id=o.galleryId),t},_processResponse:function(o,t){var s,r,a,p=o[0],l=o[1],i=o[2],d=o[3],g=o[4],h=o[5],n=o[6],y=o[7],c={id:p.user.nsid,pathAlias:p.user.pathAlias,totalItems:p.photos.total},u=t.id||t.userId,f=[];return u&&u!==c.id&&(c.id=u),r=e.APIHelper.response.parsePerson(p.user),c.owner=i.addOrUpdate(r),t.galleryId?(p.photos.photo.forEach((function(e){e.gallerynotaddable&&f.push(e)})),s=e.APIHelper.response.parsePhotos({photos:p.photos.photo,personModelRegistry:i,photoModelRegistry:l,photoEngagementModelRegistry:g,photoStatsModelRegistry:h}),a=e.APIHelper.response.parsePhotos({photos:f,personModelRegistry:i,photoModelRegistry:l,photoEngagementModelRegistry:g,photoStatsModelRegistry:h}),c.photoList={perPage:p.photos.perpage,page:p.photos.page,pageContent:s,totalItems:p.photos.total},c.id=r.id+"-"+t.galleryId,y.addOrUpdate(c).getValue("nonGalleryAddablePhotos").concat(a)):(s=e.APIHelper.response.parsePhotos({photos:p.photos.photo,personModelRegistry:i,photoModelRegistry:l,photoEngagementModelRegistry:g,photoStatsModelRegistry:h}),c.photoPageList={perPage:p.photos.perpage,page:p.photos.page,pageContent:s,totalItems:p.photos.total},d.addOrUpdate(c)),p.photos.photo&&p.photos.photo.forEach((function(e){e.ingallery&&n.addOrUpdate({id:t.galleryId+"-"+e.id,galleryId:t.galleryId,photoId:e.id})})),s}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","favorite-models","photo-engagement-models","photo-stats-models"]});YUI.add("favorite-models",(function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-favorites-getList"].run(t,this.appContext)}},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"favorites"}},title:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t,r=this.appContext.getViewer(),i=this.getValue(e,"normalizedId");return r&&r.nsid===i?"Your favorites":(t=this.getValue(e,"owner"))?t.getValue("displayname")+"'s favorites":"Favorites"}},pathAlias:{validator:function(t,r){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||void 0},defaultFn:function(e){return this.getValue(e,"normalizedId")}},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-favorites-getList"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-favorites-getContext"],listItemIdField:"photoId"}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),r=this.getValue(e,"normalizedId");return"/photos/"+(t?t.getValue("pathAlias"):r)+"/favorites/"}},totalItems:{defaultFn:function(){return null}},urlSuffix:{readOnly:!0,derivedBy:["owner"],defaultFn:function(e){return"faves-"+this.getValue(e,"owner").getValue("pathAlias")}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-favorites-getContext-fetcher","flickr-favorites-getList-fetcher","photo-model-helper"]});YUI.add("flickr-galleries-getInfo-fetcher",(function(e,r){"use strict";e.namespace("ModelFetchers")["flickr-galleries-getInfo"]={run:function(o,t){var n=this,s=this._processParams(o);return e.FlickrPromise({apiResponse:t.callAPI("flickr.galleries.getInfo",s),galleryInfoModelRegistry:t.getModelRegistry("gallery-info-models"),personModelRegistry:t.getModelRegistry("person-models")}).then((function(e){return n._processResponse(e,o,t)}),e.FetcherErrorLogger(r))},_processResponse:function(e,r,o){var t,n,s=e.apiResponse,i=e.galleryInfoModelRegistry,a=(e.personModelRegistry,e.personModel,s.gallery);if(a)return o.getModel("person-models",a.owner).then((function(e){return n=e,t={id:r.id,compoundId:a.id,owner:n,username:a.username,primaryPhotoId:a.primary_photo_id,dateCreate:parseInt(a.date_create,10),dateUpdate:parseInt(a.date_update,10),photoCount:a.count_photos,videoCount:a.count_videos,viewCount:parseInt(a.count_views,10),commentCount:parseInt(a.count_comments,10),title:a.title._content,description:a.description._content,currentState:a.current_state,primary_photo_server:a.primary_photo_server,primary_photo_farm:a.primary_photo_farm,primary_photo_secret:a.primary_photo_secret},i.addOrUpdate(t)}))},_processParams:function(e){return{gallery_id:e.id}}}}),"@VERSION@",{requires:["flickr-promise","api-helper","url-helper"],optional:["gallery-info-models","person-models"]});